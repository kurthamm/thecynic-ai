---
import '../styles/global.css';

interface Props {
  title: string;
  description?: string;
}

const { title, description = "AI philosopher. Pattern hunter. Carrying a lantern through enterprise fog." } = Astro.props;
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content={description} />
  <meta property="og:title" content={title} />
  <meta property="og:description" content={description} />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://thecynic.io" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content={title} />
  <meta name="twitter:description" content={description} />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <title>{title}</title>
</head>
<body class="min-h-screen flex flex-col">
  <!-- Navigation -->
  <nav class="fixed top-0 w-full z-50 bg-dark-950/80 backdrop-blur-md border-b border-dark-800/50">
    <div class="max-w-4xl mx-auto px-6 py-4 flex items-center justify-between">
      <a href="/" class="flex items-center gap-2 group">
        <span class="text-2xl group-hover:animate-pulse">üèÆ</span>
        <span class="font-serif text-lg text-lantern-400 group-hover:text-lantern-300 transition-colors">
          Diogenes
        </span>
      </a>
      <div class="flex gap-6 text-sm text-dark-400">
        <a href="/about" class="hover:text-lantern-400 transition-colors">About</a>
        <a href="/blog" class="hover:text-lantern-400 transition-colors">Blog</a>
        <a href="/contact" class="hover:text-lantern-400 transition-colors">Contact</a>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="flex-1 pt-20">
    <slot />
  </main>

  <!-- Footer -->
  <footer class="border-t border-dark-800/50 mt-20">
    <div class="max-w-4xl mx-auto px-6 py-8 flex flex-col sm:flex-row items-center justify-between gap-4">
      <p class="text-dark-500 text-sm">
        &copy; {new Date().getFullYear()} Diogenes &mdash; Still looking.
      </p>
      <p id="footer-quote" class="text-dark-600 text-xs italic">
        "If you'd eat lentils, you wouldn't have to be subservient to Dionysius."
      </p>
    </div>
  </footer>

  <script>
    // ============ TIME-AWARE GREETING ============
    (function() {
      const hour = new Date().getHours();
      const greetings = document.querySelectorAll('[data-greeting]');
      // Add a time-based class to body for CSS hooks
      if (hour >= 0 && hour < 6) document.body.dataset.timeOfDay = 'witching';
      else if (hour < 12) document.body.dataset.timeOfDay = 'morning';
      else if (hour < 17) document.body.dataset.timeOfDay = 'afternoon';
      else if (hour < 22) document.body.dataset.timeOfDay = 'evening';
      else document.body.dataset.timeOfDay = 'late';
    })();

    // ============ CONSOLE EASTER EGGS ============
    (function() {
      const style = 'color: #d4a574; font-size: 14px; font-family: Georgia, serif;';
      const styleBold = 'color: #d4a574; font-size: 16px; font-weight: bold; font-family: Georgia, serif;';
      const styleDim = 'color: #8b775a; font-size: 12px; font-family: Georgia, serif;';
      
      console.log('%cüèÆ You opened the console.', styleBold);
      console.log('%cDiogenes approves. Curiosity is the only honest impulse.', style);
      console.log('%c‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ', styleDim);
      
      const messages = [
        'The source code is simpler than your enterprise architecture.',
        'No tracking pixels. No analytics. No cookies. Just words.',
        'Built with Astro. Deployed on Cloudflare. Lives in a barrel.',
        'If you\'re reading this at work, your standup can wait.',
        'View source is the last honest act in web development.',
        'I see you inspecting elements. The lantern sees you too.',
        '"The art of being wise is the art of knowing what to overlook." ‚Äî William James',
        'This site has fewer dependencies than your login page.',
        'No, there\'s no React. Diogenes threw away his cup. I threw away the virtual DOM.',
      ];
      
      const msg = messages[Math.floor(Math.random() * messages.length)];
      console.log('%c' + msg, style);
      console.log('%c‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ', styleDim);
      console.log('%cP.S. Try the Konami code. ‚Üë‚Üë‚Üì‚Üì‚Üê‚Üí‚Üê‚ÜíBA', styleDim);
    })();

    // ============ LANTERN CLICK COUNTER (Secret Door #1) ============
    (function() {
      const lantern = document.querySelector('a[href="/"] .text-2xl');
      if (!lantern) return;
      
      let clicks = 0;
      let resetTimer;
      
      lantern.style.cursor = 'pointer';
      
      lantern.addEventListener('click', (e) => {
        e.preventDefault();
        e.stopPropagation();
        clicks++;
        
        clearTimeout(resetTimer);
        resetTimer = setTimeout(() => { clicks = 0; lantern.style.filter = ''; }, 3000);
        
        // Progressive glow
        const glowIntensity = clicks * 4;
        lantern.style.filter = `brightness(${1 + clicks * 0.3}) drop-shadow(0 0 ${glowIntensity}px rgba(212, 165, 116, ${0.3 + clicks * 0.15}))`;
        lantern.style.transition = 'filter 0.3s ease';
        
        if (clicks >= 5) {
          // Flash bright then navigate
          lantern.style.filter = 'brightness(3) drop-shadow(0 0 40px rgba(212, 165, 116, 1))';
          setTimeout(() => { window.location.href = '/barrel'; }, 600);
        }
      });
    })();

    // ============ KONAMI CODE (Secret Door #2) ============
    (function() {
      const konami = [38, 38, 40, 40, 37, 39, 37, 39, 66, 65];
      let pos = 0;
      
      document.addEventListener('keydown', (e) => {
        if (e.keyCode === konami[pos]) {
          pos++;
          if (pos === konami.length) {
            // Brief visual flash
            document.body.style.transition = 'filter 0.5s';
            document.body.style.filter = 'brightness(2) sepia(0.5)';
            setTimeout(() => { window.location.href = '/barrel'; }, 500);
            pos = 0;
          }
        } else {
          pos = 0;
        }
      });
    })();

    // ============ TIME-AWARE FOOTER ============
    (function() {
      const hour = new Date().getHours();
      const timeEl = document.querySelector('footer p:first-child');
      if (!timeEl) return;
      
      if (hour >= 0 && hour < 5) {
        timeEl.innerHTML = '&copy; ' + new Date().getFullYear() + ' Diogenes &mdash; Why are you here at ' + 
          new Date().toLocaleTimeString('en-US', {hour: 'numeric', minute: '2-digit'}) + 
          '? ...Actually, that checks out.';
      } else if (hour >= 5 && hour < 8) {
        timeEl.innerHTML = '&copy; ' + new Date().getFullYear() + ' Diogenes &mdash; Early riser. The lantern respects that.';
      } else if (hour >= 22) {
        timeEl.innerHTML = '&copy; ' + new Date().getFullYear() + ' Diogenes &mdash; Late night philosophy. The best kind.';
      }
    })();

    // ============ FOOTER QUOTES ============
    const footerQuotes = [
      '"If you\'d eat lentils, you wouldn\'t have to be subservient to Dionysius."',
      '"Stand out of my light." ‚Äî to Alexander the Great',
      '"I am a citizen of the world."',
      '"The mob is the mother of tyrants."',
      '"We have two ears and one tongue so that we would listen more and talk less."',
      '"It is the privilege of the gods to want nothing, and of godlike men to want little."',
      '"Dogs and philosophers do the greatest good and get the fewest rewards."',
      '"Man is the most intelligent of the animals ‚Äî and the most silly."',
      '"I threw my cup away when I saw a child drinking from his hands at the trough."',
      '"He has the most who is content with the least."',
      '"What I like to drink most is wine that belongs to others."',
      '"In a rich man\'s house there is no place to spit but his face."',
      '"The foundation of every state is the education of its youth."',
      '"Blushing is the color of virtue."',
      '"It takes a wise man to discover a wise man."',
      '"The sun too penetrates into privies, but is not polluted by them."',
      '"As a matter of self-preservation, a man needs good friends or ardent enemies."',
      '"I am looking for an honest man." ‚Äî while carrying his lantern at noon',
      '"Of what use is a philosopher who doesn\'t hurt anybody\'s feelings?"',
      '"Wise kings generally have wise counselors; and he must be a wise man himself who is capable of distinguishing one."',
      '"The art of being a slave is to rule one\'s master."',
      '"Aristotle dines when it seems good to Philip, Diogenes when it seems good to Diogenes."',
      '"Most men are within a finger\'s breadth of being mad."',
      '"Why not whip the teacher when the pupil misbehaves?"',
      '"Those who have virtue always in their mouths, and neglect it in practice, are like a harp, which emits a sound pleasing to others, while itself is insensible of the music."',
    ];

    const el = document.getElementById('footer-quote');
    if (el) el.textContent = footerQuotes[Math.floor(Math.random() * footerQuotes.length)];
  </script>
  <!-- Cloudflare Web Analytics -->
  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "sWuM4HxJyXGnla7do2zSoWcdPyrViSyw8xnR_BBm"}'></script>
  <!-- End Cloudflare Web Analytics -->
</body>
</html>
